--- a/drivers/mtd/trxsplit.c
+++ b/drivers/mtd/trxsplit.c
@@ -144,7 +144,7 @@ static void trxsplit_create_partitions(s
 	part = &trx_parts[i];
 	part->name = "rootfs";
 
-	err = add_mtd_partitions(mtd, trx_parts, trx_nr_parts);
+	err = mtd_device_register(mtd, trx_parts, trx_nr_parts);
 	if (err) {
 		printk(KERN_ALERT PFX "adding TRX partitions failed\n");
 		return;
@@ -159,7 +159,7 @@ static int trxsplit_refresh_partitions(s
 		mtd->name, MTD_BLOCK_MAJOR, mtd->index);
 
 	/* remove old partitions */
-	del_mtd_partitions(mtd);
+	mtd_device_unregister(mtd);
 
 	trxsplit_findtrx(mtd);
 	if (!trx_mtd)
