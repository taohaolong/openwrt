diff -urN madwifi-ng-refcount-r2313-20070505.old/net80211/ieee80211_beacon.c madwifi-ng-refcount-r2313-20070505.dev/net80211/ieee80211_beacon.c
--- madwifi-ng-refcount-r2313-20070505.old/net80211/ieee80211_beacon.c	2007-05-13 18:17:56.687951160 +0200
+++ madwifi-ng-refcount-r2313-20070505.dev/net80211/ieee80211_beacon.c	2007-05-13 18:17:56.971907992 +0200
@@ -512,7 +512,7 @@
 			vap->iv_flags &= ~IEEE80211_F_XRUPDATE;
 		}
 #endif
-		if (ic->ic_flags_ext & IEEE80211_FEXT_ERPUPDATE) {
+		if ((ic->ic_flags_ext & IEEE80211_FEXT_ERPUPDATE) && (bo->bo_erp != NULL)) {
 			(void) ieee80211_add_erp(bo->bo_erp, ic);
 			ic->ic_flags_ext &= ~IEEE80211_FEXT_ERPUPDATE;
 		}
