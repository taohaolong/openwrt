diff --exclude '*~' -uNr madwifi-dfs-r3053.orig/ath_rate/minstrel/minstrel.c madwifi-dfs-r3053/ath_rate/minstrel/minstrel.c
--- madwifi-dfs-r3053.orig/ath_rate/minstrel/minstrel.c	2007-12-21 13:34:23.000000000 +0000
+++ madwifi-dfs-r3053/ath_rate/minstrel/minstrel.c	2007-12-21 14:29:07.000000000 +0000
@@ -449,7 +449,6 @@
 		const struct ath_desc *ds = &bf->bf_desc[0];
 		int final_rate = 0;
 		int tries = 0;
-		int ndx = -1;
 		int mrr;
 		int final_ndx;
 		int rate0, tries0, ndx0;
@@ -488,8 +487,8 @@
 		mrr = sc->sc_mrretry && !(ic->ic_flags & IEEE80211_F_USEPROT) && ENABLE_MRR;
 
 		if (!mrr) {
-			if ((0 <= ndx) && (ndx < sn->num_rates)) {
-				sn->rs_rateattempts[ndx]++; /* only one rate was used */
+			if ((0 <= final_ndx) && (final_ndx < sn->num_rates)) {
+				sn->rs_rateattempts[final_ndx]++; /* only one rate was used */
 			}
 			return;
 		}
