diff -urN madwifi-ng-refcount-r2313-20070505.old/ath_rate/minstrel/minstrel.c madwifi-ng-refcount-r2313-20070505.dev/ath_rate/minstrel/minstrel.c
--- madwifi-ng-refcount-r2313-20070505.old/ath_rate/minstrel/minstrel.c	2007-04-25 22:29:55.000000000 +0200
+++ madwifi-ng-refcount-r2313-20070505.dev/ath_rate/minstrel/minstrel.c	2007-05-13 18:17:55.533126720 +0200
@@ -543,6 +543,9 @@
         unsigned int i, column_index;
         int newIndex;
         u_int8_t random_bytes[12];
+		
+		if (num_sample_rates < 0)
+			return;
 
         for(column_index = 0; column_index < MINSTREL_COLUMNS; column_index++) {
                 for (i = 0; i <= IEEE80211_RATE_MAXSIZE; i++)
