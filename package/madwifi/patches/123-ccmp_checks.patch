Only in madwifi.dev/ath: if_ath.c.orig
diff -ur madwifi.old/net80211/ieee80211_crypto_ccmp.c madwifi.dev/net80211/ieee80211_crypto_ccmp.c
--- madwifi.old/net80211/ieee80211_crypto_ccmp.c	2007-06-02 04:37:47.425966000 +0200
+++ madwifi.dev/net80211/ieee80211_crypto_ccmp.c	2007-06-02 18:38:27.675882768 +0200
@@ -465,6 +465,9 @@
 	uint8_t *mic, *pos;
 	u_int space;
 
+	if (ctx->cc_tfm == NULL)
+		return 0;
+
 	ctx->cc_vap->iv_stats.is_crypto_ccmp++;
 
 	skb = skb0;
@@ -579,6 +582,9 @@
 	uint8_t *pos, *mic;
 	u_int space;
 
+	if (ctx->cc_tfm == NULL)
+		return 0;
+
 	ctx->cc_vap->iv_stats.is_crypto_ccmp++;
 
 	skb = skb0;
